<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Douglas Music</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1db954">
<link rel="apple-touch-icon" href="icons/icon-192.png">

<style>
body{
  background:#0b0b0b;
  color:#fff;
  font-family:system-ui, Arial;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
  margin:0;
}
.box{
  text-align:center;
  width:90%;
  max-width:360px;
}
button{
  background:#1db954;
  border:none;
  color:#fff;
  padding:12px 18px;
  border-radius:10px;
  font-size:16px;
  cursor:pointer;
  margin-top:10px;
}
audio{
  width:100%;
  margin-top:15px;
}
</style>
</head>
<body>

<div class="box">
  <h1>ðŸŽµ Douglas Music</h1>

  <audio id="audio" controls>
    <source src="musica.mp3" type="audio/mpeg">
    Seu navegador nÃ£o suporta Ã¡udio.
  </audio>

  <button id="btnInstall" hidden>ðŸ“² Instalar App</button>
</div>

<script>
// ================= SERVICE WORKER =================
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}

// ================= MEDIA SESSION =================
const audio = document.getElementById('audio');

function updateMediaSession(){
  if ('mediaSession' in navigator) {
    navigator.mediaSession.metadata = new MediaMetadata({
      title: 'Douglas Music',
      artist: 'Player',
      album: 'Douglas Music',
      artwork: [
        { src: 'icons/icon-192.png', sizes: '192x192', type: 'image/png' },
        { src: 'icons/icon-512.png', sizes: '512x512', type: 'image/png' }
      ]
    });

    navigator.mediaSession.setActionHandler('play', () => audio.play());
    navigator.mediaSession.setActionHandler('pause', () => audio.pause());
  }
}

audio.addEventListener('play', updateMediaSession);

// ================= INSTALAR PWA =================
let deferredPrompt;
const btnInstall = document.getElementById('btnInstall');

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  btnInstall.hidden = false;
});

btnInstall.addEventListener('click', async () => {
  if (!deferredPrompt) return;
  deferredPrompt.prompt();
  await deferredPrompt.userChoice;
  deferredPrompt = null;
  btnInstall.hidden = true;
});
</script>

</body>
</html>