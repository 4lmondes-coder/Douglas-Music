<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Player Douglas Almondes</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1db954">
<link rel="apple-touch-icon" href="icons/icon-192.png">

<script src="https://cdn.jsdelivr.net/npm/jsmediatags@3.9.7/dist/jsmediatags.min.js"></script>

<style>
:root{
  --bg:#0b0b0b;
  --panel:#121212;
  --muted:#bdbdbd;
  --accent:#1db954;
  --accent-2:#14a746;
}

body{
  margin:0;
  background:var(--bg);
  color:#fff;
  font-family:system-ui, Arial;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
}

.player{
  background:var(--panel);
  padding:24px;
  border-radius:16px;
  width:320px;
  text-align:center;
  box-shadow:0 10px 30px rgba(0,0,0,.5);
}

.cover{
  width:200px;
  height:200px;
  background:#222;
  margin:0 auto 16px;
  border-radius:12px;
  overflow:hidden;
}

.cover img{
  width:100%;
  height:100%;
  object-fit:cover;
}

button{
  background:var(--accent);
  border:none;
  padding:10px 18px;
  border-radius:999px;
  font-weight:bold;
  cursor:pointer;
  margin:6px;
}
</style>
</head>

<body>

<div class="player">
  <div class="cover">
    <img id="coverImg" alt="Capa" style="display:none">
  </div>

  <h2 id="musicTitle">Douglas Music</h2>

  <input id="fileInput" type="file" accept="audio/*" multiple>

  <div style="margin-top:12px;">
    <button id="playBtn">▶️ Play</button>
    <button id="pauseBtn">⏸️ Pause</button>
  </div>
</div>

<audio id="audio" crossorigin="anonymous"></audio>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}

const audio = document.getElementById('audio');
const fileInput = document.getElementById('fileInput');
const playBtn = document.getElementById('playBtn');
const pauseBtn = document.getElementById('pauseBtn');
const title = document.getElementById('musicTitle');
const coverImg = document.getElementById('coverImg');

let playlist = [];
let index = 0;

fileInput.addEventListener('change', e=>{
  playlist = Array.from(e.target.files);
  index = 0;
  loadTrack();
});

function loadTrack(){
  if(!playlist.length) return;

  const file = playlist[index];
  audio.src = URL.createObjectURL(file);
  title.textContent = file.name;

  if(window.jsmediatags){
    jsmediatags.read(file,{
      onSuccess: tag=>{
        const pic = tag.tags.picture;
        if(pic){
          let base64="";
          for(let i=0;i<pic.data.length;i++){
            base64+=String.fromCharCode(pic.data[i]);
          }
          coverImg.src=`data:${pic.format};base64,${btoa(base64)}`;
          coverImg.style.display='block';
        }
      }
    });
  }
}

playBtn.onclick=()=>audio.play();
pauseBtn.onclick=()=>audio.pause();
</script>

</body>
</html>
